{"version":3,"sources":["../../../src/commands/auth/login.ts"],"sourcesContent":["import { Config } from '@oclif/core';\n// @ts-ignore\nimport { Listr } from 'listr2';\n\nimport { getAuthorizedClient } from '@condohub/apis';\nimport { AppError, ERROR_TYPE } from '@condohub/common-utils';\n\nimport BaseCommand from '../../base-command';\nimport { UserConfig } from '../../models/user-config.model';\nimport { getUserConfig } from '../../utilities/config.utilities';\n\ninterface Ctx {\n  /* some variables for internal use */\n}\n\nexport default class AuthLogin extends BaseCommand {\n  static description = 'Authenticate your CLI client';\n\n  static examples = [`$ condohub auth login`];\n\n  static args = [{ name: 'test' }];\n\n  constructor(argv: string[], config: Config) {\n    super(argv, config, { name: 'auth:login' });\n  }\n\n  async init() {\n    let [id, ...argv] = this.argv;\n  }\n\n  async run() {\n    const { args } = await this.parse(AuthLogin);\n\n    let userConfig: UserConfig | undefined;\n    try {\n      userConfig = getUserConfig(this.config);\n    } catch (error) {\n      throw new AppError({\n        name: ERROR_TYPE.ENV_ERROR,\n        message: 'Missing user config information, aborting.',\n      });\n    }\n\n    if (!userConfig) {\n      throw new AppError({\n        name: ERROR_TYPE.CLI_ERROR,\n        message: 'No user config.json found, did you run `condohub config init` first?',\n      });\n    }\n\n    try {\n      this.logCommand('Authorizing');\n      // const client = getAuthorizedClient();\n    } catch (error) {}\n\n    // try {\n    //   const client = getAuthorizedClient();\n    // } catch (error) {}\n\n    const tasks = new Listr<Ctx>(\n      [\n        {\n          title: '  This task will execute.',\n          task: (ctx, task): Listr =>\n            task.newListr([\n              {\n                title: '  This is a subtask.',\n                task: async (): Promise<string> => {\n                  return new Promise((resolve, reject) => {\n                    setTimeout(() => {\n                      resolve('Done');\n                    }, 3000);\n                  });\n                },\n              },\n            ]),\n        },\n      ],\n      {\n        rendererOptions: {\n          showTimer: true,\n          indentation: 2,\n        },\n        /* options */\n      }\n    );\n    try {\n      await tasks.run();\n    } catch (e) {\n      console.error(e);\n    }\n\n    this.log(`running in ${process.cwd()}`);\n  }\n}\n"],"names":["AuthLogin","BaseCommand","description","examples","args","name","constructor","argv","config","init","id","run","parse","userConfig","getUserConfig","error","AppError","ERROR_TYPE","ENV_ERROR","message","CLI_ERROR","logCommand","tasks","Listr","title","task","ctx","newListr","Promise","resolve","reject","setTimeout","rendererOptions","showTimer","indentation","e","console","log","process","cwd"],"mappings":"AAAA;;;;;AAEsB,IAAA,OAAQ,WAAR,QAAQ,CAAA;AAGO,IAAA,YAAwB,WAAxB,wBAAwB,CAAA;AAErC,IAAA,YAAoB,kCAApB,oBAAoB,EAAA;AAEd,IAAA,gBAAkC,WAAlC,kCAAkC,CAAA;AAMjD,MAAMA,SAAS,SAASC,YAAW,QAAA;IAChD,OAAOC,WAAW,GAAG,8BAA8B,CAAC;IAEpD,OAAOC,QAAQ,GAAG;QAAC,CAAC,qBAAqB,CAAC;KAAC,CAAC;IAE5C,OAAOC,IAAI,GAAG;QAAC;YAAEC,IAAI,EAAE,MAAM;SAAE;KAAC,CAAC;IAEjCC,YAAYC,IAAc,EAAEC,MAAc,CAAE;QAC1C,KAAK,CAACD,IAAI,EAAEC,MAAM,EAAE;YAAEH,IAAI,EAAE,YAAY;SAAE,CAAC,CAAC;KAC7C;IAED,MAAMI,IAAI,GAAG;QACX,IAAI,CAACC,EAAE,EAAE,GAAGH,IAAI,CAAC,GAAG,IAAI,CAACA,IAAI,AAAC;KAC/B;IAED,MAAMI,GAAG,GAAG;QACV,MAAM,EAAEP,IAAI,CAAA,EAAE,GAAG,MAAM,IAAI,CAACQ,KAAK,CAACZ,SAAS,CAAC,AAAC;QAE7C,IAAIa,UAAU,AAAwB,AAAC;QACvC,IAAI;YACFA,UAAU,GAAGC,CAAAA,GAAAA,gBAAa,AAAa,CAAA,cAAb,CAAC,IAAI,CAACN,MAAM,CAAC,CAAC;SACzC,CAAC,OAAOO,KAAK,EAAE;YACd,MAAM,IAAIC,YAAQ,SAAA,CAAC;gBACjBX,IAAI,EAAEY,YAAU,WAAA,CAACC,SAAS;gBAC1BC,OAAO,EAAE,4CAA4C;aACtD,CAAC,CAAC;SACJ;QAED,IAAI,CAACN,UAAU,EAAE;YACf,MAAM,IAAIG,YAAQ,SAAA,CAAC;gBACjBX,IAAI,EAAEY,YAAU,WAAA,CAACG,SAAS;gBAC1BD,OAAO,EAAE,sEAAsE;aAChF,CAAC,CAAC;SACJ;QAED,IAAI;YACF,IAAI,CAACE,UAAU,CAAC,aAAa,CAAC,CAAC;QAC/B,wCAAwC;SACzC,CAAC,OAAON,MAAK,EAAE,EAAE;QAElB,QAAQ;QACR,0CAA0C;QAC1C,qBAAqB;QAErB,MAAMO,KAAK,GAAG,IAAIC,OAAK,MAAA,CACrB;YACE;gBACEC,KAAK,EAAE,2BAA2B;gBAClCC,IAAI,EAAE,CAACC,GAAG,EAAED,IAAI,GACdA,IAAI,CAACE,QAAQ,CAAC;wBACZ;4BACEH,KAAK,EAAE,sBAAsB;4BAC7BC,IAAI,EAAE,UAA6B;gCACjC,OAAO,IAAIG,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,GAAK;oCACtCC,UAAU,CAAC,IAAM;wCACfF,OAAO,CAAC,MAAM,CAAC,CAAC;qCACjB,EAAE,IAAI,CAAC,CAAC;iCACV,CAAC,CAAC;6BACJ;yBACF;qBACF,CAAC;aACL;SACF,EACD;YACEG,eAAe,EAAE;gBACfC,SAAS,EAAE,IAAI;gBACfC,WAAW,EAAE,CAAC;aACf;SAEF,CACF,AAAC;QACF,IAAI;YACF,MAAMZ,KAAK,CAACX,GAAG,EAAE,CAAC;SACnB,CAAC,OAAOwB,CAAC,EAAE;YACVC,OAAO,CAACrB,KAAK,CAACoB,CAAC,CAAC,CAAC;SAClB;QAED,IAAI,CAACE,GAAG,CAAC,CAAC,WAAW,EAAEC,OAAO,CAACC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;KACzC;CACF;kBA/EoBvC,SAAS"}